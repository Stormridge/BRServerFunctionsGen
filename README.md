# Battle Royale Server Functions Generator
This simple .NET application is used to autogenerate SQF function definitions, which can then be compiled as readonly variables when the server starts.  I wrote this while eating a snickers since I was tired of manually defining SQF variables and their target SQF file.  I also don't like editing configs.

To learn more about Arma 3 Battle Royale, visit our [Battle Royale Discord](https://discord.gg/0VyanbPZ8SsaJU5p)

# Overview
Since SQF lacks object-oriented encapsulation and naming, Battle Royale Mod uses a simple and dirty way of defining functions and keeping them organized.  This lets the mod developer create and declare a new method simply by creating a new SQF file.  When BR Mod loads, it immediately compiles the mod files as readonly variables.

Since I use Sublime Text as a text editor, Sublime gives you a nice treeview of your source files and folders.  By using this functions generation tool, each folder in the source tree represents a namespace, and files represent the method name.

The functions generate simply walks the directory tree, creating 'namespaces', then defines a SQF variable for each file.  The prefix of the variable then becomes an underscore-separated list of the directories leading to the variable.  This is a way of faking namespaces.

# Example
My br_client mod has a file in this path:
<pre><code>.\br_client\Game\Effects\MuteSound.sqf</pre></code>

My pbo compilation script then runs this command:
<pre><code>call "%TOOLS%\BRServerFunctionsGen.exe" "%BR_CLIENT_SOURCE%\addons\br_client" "%BR_CLIENT_SOURCE%\addons\br_client\functions.hpp" BR_Client</pre></code>

This tells BRServerFunctionsGen to parse the br_client folder, looking for SQF files, and the resulting SQF variable definitions will go into the file, functions.hpp.

In our example, the following line in functions.hpp will be created for MuteSounds.sqf:
<pre><code>
/* AUTOGENERATED FILE */
BR_CLIENT_PREDEFINED_FUNCTIONS = [
  ...
	["BR_Client_Game_Effects_MuteSound","br_client\Game\Effects\MuteSound.sqf"],
  ...
];
</pre></code>

We only had to create a SQF file, and the result is a variable called BR_Client_Game_Effects_MuteSound that we can call from SQF.

# Wiring up functions in your mod
1. Create a config definition for your mod that tells Arma to call preInit/postInit functions.

<pre><code>
class CfgFunctions
{
	// https://community.bistudio.com/wiki/Functions_Library_(Arma_3)
	class br_client
	{
		class Initialize
		{
			file = "br_client\init";
			class preInit
			{
				preInit = 1;
			};
			class postInit
			{
				postInit = 1;
			};
		};
  };
};
</pre></code>

2. In your fn_preInit.sqf file, parse your Functions.hpp into variables.

<pre><code>
{
	_sqfFile = _x select 1;
	_compiledCode = compileFinal (preprocessFileLineNumbers _sqfFile);
	missionNamespace setVariable [_x select 0, _compiledCode];
} forEach BR_CLIENT_PREDEFINED_FUNCTIONS;
</pre></code>

3. That's it.
